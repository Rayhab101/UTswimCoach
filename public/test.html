<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Utah Swim Coach - Records</title>
    <link rel="stylesheet" href="swim.css">
    <script src="https://code.jquery.com/jquery-3.3.1.js"
        integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous">
        </script>
    <script>
        $(function () {
            $("#header").load("heading.html");
            $("footer").load("footing.html");
        });
    </script>
    <style>
        .swim_info {
            padding-top: 90px;
        }
        .container1{
            display: grid;
            background-color: white;
            border-radius: 6px;
            -moz-border-radius: 6px;
        }

        table,
        tr {
            background-color: rgba(255, 255, 255, .95);
            border-collapse: separate;
            border: solid white 1px;
            border-radius: 6px;
            -moz-border-radius: 6px;
            text-align: center;
            width: 90%;
            margin-left: auto;
            margin-right: auto;

        }
        td {
            height: 25px;
            border-collapse: separate;
            border: solid white 1px;
            border-radius: 6px;
            -moz-border-radius: 6px;
        }
        th {
            text-align: center;
            font-size: 24px;
        }

        button {
            margin-left: auto;
            margin-right: auto;
        }
        .swimmer_data1{
            grid-row: 1;
            grid-column: 1;
        }
        .swimmer_data2{
            grid-row: 1;
            grid-column: 2;
        }
        .swimmer_data3{
            grid-row: 1;
            grid-column: 3;
        }
    </style>
    <script>
        // function pullGirlRecord(i, school) {
        //     var body = document.getElementById("swimmer_data");
        //     fetch("/api/races/" + i)
        //         .then(function (response) {
        //             return response.json();
        //         })
        //         .then(function (race) {
        //             var row = document.createElement("tr");
        //             var column = document.createElement("td");
        //             var cell = row.insertCell();
        //             text = document.createTextNode(column.innerHTML = race[0].title);
        //             cell.appendChild(text);
        //             fetch("/api/schoolRecord/" + i + "&" + school)
        //                 .then(function (responseSchool) {
        //                     return responseSchool.json();
        //                 })
        //                 .then(function (record) {
        //                     fetch("/api/swimmers/" + record[0].swimmer_id)
        //                         .then(function (responseRelay) {
        //                             return responseRelay.json();
        //                         })
        //                         .then(function (swimmer) {
        //                             var column = document.createElement("td");
        //                             var cell = row.insertCell();
        //                             text = document.createTextNode(column.innerHTML = swimmer[0].name);
        //                             cell.appendChild(text);
        //                             var column = document.createElement("td");
        //                             var cell = row.insertCell();
        //                             text = document.createTextNode(column.innerHTML = record[0].time);
        //                             cell.appendChild(text);
        //                             var column = document.createElement("td");
        //                             var cell = row.insertCell();
        //                             text = document.createTextNode(column.innerHTML = record[0].year);
        //                             cell.appendChild(text);
        //                             body.appendChild(row);
        //                         })
        //                         .catch(function (error) {
        //                             console.log("Error: " + error);
        //                         });
        //                 })
        //                 .catch(function (error) {
        //                     console.log("Error: " + error);
        //                 });
        //         })
        //         .catch(function (error) {
        //             console.log("Error: " + error);
        //         });
        // }

        // function pullRelay(i, school) {
        //     //console.log(i, school);
        //     fetch("/api/relayRecord/" + i + "&" + school)
        //         .then(function (responseRelay) {
        //             return responseRelay.json();
        //         })
        //         .then(function (relay) {
        //             var body = document.getElementById("swimmer_data");
        //             fetch("/api/races/" + relay[0].race)
        //                 .then(function (responseRace) {
        //                     return responseRace.json();
        //                 })
        //                 .then(function (race) {
        //                     console.log(race);
        //                     if (race[0].race_id < 12) {
        //                         console.log("HI")
        //                     }
        //                     var row = document.createElement("tr");
        //                     var column = document.createElement("td");
        //                     var cell = row.insertCell();
        //                     text = document.createTextNode(column.innerHTML = relay[0].swimmers);
        //                     cell.appendChild(text);
        //                     var column = document.createElement("td");
        //                     var cell = row.insertCell();
        //                     text = document.createTextNode(column.innerHTML = relay[0].time);
        //                     cell.appendChild(text);
        //                     var column = document.createElement("td");
        //                     var cell = row.insertCell();
        //                     text = document.createTextNode(column.innerHTML = relay[0].year);
        //                     cell.appendChild(text);
        //                     var column = document.createElement("td");
        //                     var cell = row.insertCell();
        //                     text = document.createTextNode(column.innerHTML = race[0].title);
        //                     cell.appendChild(text);
        //                     body.appendChild(row);
        //                 })
        //                 .catch(function (error) {
        //                     console.log("Error: " + error);
        //                 });
        //         })
        //         .catch(function (error) {
        //             console.log("Error: " + error);
        //         });
        // }

        function recordPull(race, cell, school) {
            var relays = [1, 8, 11, 12, 19, 22]
            console.log(cell.id[1])
            race = cell.id[1] == "g" ? race : race+11;
            if (!relays.includes(race)) {
                fetch('/api/schoolRecord/' + race + "&" + school)
                    .then(function (response) {
                        return response.json();
                    })
                    .then(function (record) {
                        //console.log(record)
                        document.getElementById(cell.id).innerHTML = record[0].swimmer_id;
                    }).catch(function (error) {
                        console.log("Error: " + error);
                    });
            }
            else {
                fetch("/api/relayRecord/" + race + "&" + school)
                    .then(function (responseRelay) {
                        return responseRelay.json();
                    })
                    .then(function (relay) {
                        //console.log(relay)
                        document.getElementById(cell.id).innerHTML = relay[0].swimmers;
                    })
                    .catch(function (error) {
                        console.log("Error: " + error);
                    });
            }
    }

        function timePull(race,cell,school){
            var relays = [1, 8, 11, 12, 19, 22]
            console.log(cell.id[1])
            race = cell.id[1] == "g" ? race : race+11;
            if (!relays.includes(race)) {
                fetch('/api/schoolRecord/' + race + "&" + school)
                    .then(function (response) {
                        return response.json();
                    })
                    .then(function (record) {
                        //console.log(record)
                        document.getElementById(cell.id).innerHTML = record[0].time;
                    }).catch(function (error) {
                        console.log("Error: " + error);
                    });
            }
            else {
                fetch("/api/relayRecord/" + race + "&" + school)
                    .then(function (responseRelay) {
                        return responseRelay.json();
                    })
                    .then(function (relay) {
                        //console.log(relay)
                        document.getElementById(cell.id).innerHTML = relay[0].time;
                    })
                    .catch(function (error) {
                        console.log("Error: " + error);
                    });
            }
        }

        function yearPull(race,cell,school){
            var relays = [1, 8, 11, 12, 19, 22]
            console.log(cell.id[1])
            race = cell.id[1] == "g" ? race : race+11;
            if (!relays.includes(race)) {
                fetch('/api/schoolRecord/' + race + "&" + school)
                    .then(function (response) {
                        return response.json();
                    })
                    .then(function (record) {
                        //console.log(record)
                        document.getElementById(cell.id).innerHTML = record[0].year;
                    }).catch(function (error) {
                        console.log("Error: " + error);
                    });
            }
            else {
                fetch("/api/relayRecord/" + race + "&" + school)
                    .then(function (responseRelay) {
                        return responseRelay.json();
                    })
                    .then(function (relay) {
                        //console.log(relay)
                        document.getElementById(cell.id).innerHTML = relay[0].year;
                    })
                    .catch(function (error) {
                        console.log("Error: " + error);
                    });
            }
        }

        function pullSchool() {
            var school = location.search.substring(1);
            school = school.split("=");
            school = Number(school[1]);
            for (var i = 1; i < 12; i++) {
                var body = document.getElementById("girlRecords");
                var row = document.createElement('tr');
                var column = document.createElement("td");
                //var text = document.createTextNode(column.innerHTML = "A");
                var cell = row.insertCell();
                cell.setAttribute('id', 'rg' + i);
                //cell.appendChild(text);
                recordPull(i, cell, school);
                var column = document.createElement("td");
                var cell = row.insertCell();
                cell.setAttribute('id', 'rgt' + i);
                //cell.appendChild(text);
                timePull(i, cell, school);
                var column = document.createElement("td");
                var cell = row.insertCell();
                cell.setAttribute('id', 'rgy' + i);
                //cell.appendChild(text);
                body.appendChild(row);
                yearPull(i, cell, school);
            }
            var races = ["","200 Medley Relay","200 Freestyle","200 I.M.", "50 Freestyle", "100 Butterfly", "100 Freestyle", "500 Freestyle", "200 Freestyle Relay", "100 Backstroke", "100 Breaststroke", "400 Freestyle Relay"]
            for (var i = 1; i < 13; i++) {
                var body = document.getElementById("races");
                var row = document.createElement('tr');
                var column = document.createElement("td");
                var cell = row.insertCell();
                var text = document.createTextNode(column.innerHTML = races[i]);
                cell.appendChild(text);
                row.appendChild(cell);
                body.appendChild(row);
            }
            document.getElementById("races").deleteRow(12);
            for (var i = 1; i < 12; i++) {
                var body = document.getElementById("boyRecords");
                var row = document.createElement('tr');
                var column = document.createElement("td");
                //var text = document.createTextNode(column.innerHTML = "A");
                var cell = row.insertCell();
                cell.setAttribute('id', 'rb' + i);
                cell.appendChild(text);
                recordPull(i, cell, school);
                var column = document.createElement("td");
                var cell = row.insertCell();
                cell.setAttribute('id', 'rbt' + i);
                cell.appendChild(text);
                timePull(i, cell, school);
                var column = document.createElement("td");
                var cell = row.insertCell();
                cell.setAttribute('id', 'rby' + i);
                cell.appendChild(text);
                body.appendChild(row);
                yearPull(i, cell, school);
            }

            // var relays = [1, 8, 11, 12, 19, 22]
            // for (var j = 1; j <= 22; j++) {
            //     //console.log(j);
            //     if (relays.includes(j)) {
            //         pullRelay(j, school);
            //     }
            //     else {
            //         pullRecord(j, school);
            //     }
            // }
        }

    </script>
</head>

<body onload="pullSchool()">
    <header id="header"></header>
    <main class="swim_info">
        <div class="container1" id="container1">
            <table class="swimmer_data1" id="girlRecords">
                <tr style="border: solid black 1px;">
                    <td>RECORD HOLDER(S): WOMEN</td>
                    <td>TIME</td>
                    <td>YEAR</td>
                </tr>
            </table>
            <table class="swimmer_data2" id="races">
                <tr style="border: solid black 1px;">
                    <td>RACE</td>
                </tr>
            </table>
            <table class="swimmer_data3" id="boyRecords">
                <tr style="border: solid black 1px;">
                    <td>RECORD HOLDER(S): MEN</td>
                    <td>TIME</td>
                    <td>YEAR</td>
                </tr>
            </table>
        </div>
    </main>
    <footer id="footer"></footer>
</body>

</html>