<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BL/SJ Swim Team- Home</title>
    <link rel="stylesheet" href="swim.css">
    <script src="https://code.jquery.com/jquery-3.3.1.js"
        integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous">
        </script>
    <script>
        $(function () {
            $("#header").load("heading.html");
            $("#footer").load("footing.html");
        });
    </script>
    <style>
        @media only screen and (min-width: 700px) {
        .galleryPic {
            width: 30vw;
        }

        .container2 {
            width: 100vw;
            display: flex;
            justify-content: space-evenly;
            flex-wrap: wrap;
            /* overflow: hidden; */
            /* padding-left: 50px;
            padding-right: 90px; */
        }

        .welcome {
            /* padding-top: 100px; */
            color: white;
            font-size: larger;
            background-color: rgba(0, 0, 0, 0.6);
            text-align: center;
            width: 100vw;
        }

        .schedule {
            /* background-color: whitesmoke; */
            text-align: center;
            font-size: small;
            width: 30vw;
        }
        /* .schedule {
            background-color: whitesmoke;
            text-align: center;
            font-size: small;

        } */

        table {
            background-color: whitesmoke;
            visibility: visible;
        }

        body {
            height: 85vh;
            width: 100vw;
        }

        .nextmeet {
            background-image: url(vs_blpool.jpeg);
            display: flex;
            width: 30vw;
            object-fit: contain;
            background-repeat: no-repeat;
            background-position: center;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .nextmeet img {
            width: 40%;
            height: 40%;
        }

        #blog{
            height: 30vh; 
            width: 29.5vw; 
            font-size:14px;
            resize: none;

        }
    }
        @media only screen and (max-width: 700px) {
            .galleryPic {
            width: 90vw;
        }
            .container2 {
                height: 85vh;
                width: 100vw;
                /* padding-left: auto; */
                display: flex;
                justify-content: space-evenly;
                flex-wrap:wrap;
                overflow: auto;

            }
            .welcome {
            /* padding-top: 100px; */
            color: white;
            font-size: larger;
            background-color: rgba(0, 0, 0, 0.6);
            text-align: center;
            width: 90vw;
            margin-top: 100px;
        }
            .schedule {
            /* background-color: whitesmoke; */
            text-align: center;
            font-size: small;
            width: 90vw;

        }

        table {
            background-color: whitesmoke;
            visibility: visible;
        }

        body {
            height: 85vh;
            width: 100vw;
        }

        .nextmeet {
            background-image: url(vs_blpool.jpeg);
            display: flex;
            width: 90vw;
            object-fit: contain;
            background-repeat: no-repeat;
            background-position: center;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .nextmeet img {
            width: 40%;
            height: 40%;
        }

        #blog{
            height: 100%; 
            width: 90vw; 
            font-size:14px;
            resize: none;
        }
        }


    </style>
</head>
<header id="header"></header>
<div class="welcome">
    <h3>Welcome to the Ben Lomond and Saint Joseph Swim Team Web Page</h3>
</div>

<body onload="against()">
    <div class="container2">
        <div class="schedule">
            <table id="schedule">
                <tr>
                    <th colspan="6"><u>2021-2022 Swim Schedule</u></th>
                </tr>
                <tr><strong>
                        <td>Date/Day</td>
                        <td>Event</td>
                        <td>Time</td>
                        <td>Out</td>
                        <td>Bus</td>
                        <td>Home</td>
                    </strong></tr>
                <tr><strong>
                        <td>09/24/2021</td>
                        <td>Swim Meeting @The Pool</td>
                        <td>3:00pm</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </strong></tr>
                <tr><strong>
                        <td>09/27/2021</td>
                        <td>First Day of Practice</td>
                        <td>2:45pm</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </strong></tr>
                <tr><strong>
                        <td>09/30/2021</td>
                        <td>Parents Meeting RM. 311</td>
                        <td>6:00pm</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </strong></tr>
                <tr>
                    <th colspan="6"><u>Season Meets:</u></th>
                </tr>
            </table>
        </div>

        <div class="w3-content w3-section">
            <img id="mySlides" class="galleryPic">
        </div>
        <div style="background-color: rgba(0, 0, 0, 0.6)">
            <h1 style="color:white; text-align: center; ">Next Meet</h1>
            <div id="nextmeet" class="nextmeet">
            </div>
            <h3 id="meetname" style="color:white; text-align: center;"></h3>
            <br>
            <textarea id="blog" readonly></textarea>
        </div>
    </div>
    <script>
        var slideIndex = 0;
        carousel();
        function carousel() {
            var imgArray = [];
            for (i = 0; i < 5; i++) {
                imgArray[i] = new Image();
                imgArray[i] = './Gallery/Quote' + i + '.png';
            }
            var x = document.getElementById("mySlides");
            if (slideIndex === imgArray.length) { slideIndex = 0 }
            x.style.display = "block";
            x.src = imgArray[slideIndex].toString();
            slideIndex++;
            setTimeout(carousel, 10000); // Change image every 10 seconds

        }
    </script>
</body>
<footer id="footer"></footer>
<script>

    async function blog() {
        var blog = document.getElementById("blog");
        var hello = await fetch('/api/blog').then(data => data.json())
        blog.innerHTML = hello[0].blog_text;
    }

    async function against() {
        var today = new Date();
        // var redBlue = new Date(2021, 09, 22)

        fetch("/api/meets").then(function (resMeets) {
            return resMeets.json();
        })
            .then(async function (meets) {
                var body = document.getElementById("nextmeet");
                var text = document.getElementById("meetname")
                var img = document.createElement("img");
                var img2 = document.createElement("img");
                var img3 = document.createElement("img");
                var img4 = document.createElement("img");
                if (meets != "" && meets[0].year == 2) {
                    // console.log(meets[0].school1);
                    if (meets[0].school1 != -1) {
                        var school1 = await fetch('/api/schools/' + meets[0].school1).then(function (responseRelay) {
                            return responseRelay.json();
                        }).catch(function (error) {
                            console.log("Error: " + error)
                        });
                        var school2;
                        if (meets[0].school2 != null) {
                            school2 = await fetch('/api/schools/' + meets[0].school2).then(function (responseRelay) {
                                return responseRelay.json();
                            }).catch(function (error) {
                                console.log("Error: " + error)
                            });
                        }
                    }
                    else {
                        // console.log("Hello")
                        var school1 = [{ school_id: '-1', name: 'Multi Team', photo: './Utah_test.png' }];

                    }
                    // console.log(school1);
                    // console.log(meets)
                    for (var j = 0; j < meets.length; j++) {
                        var date = meets[j].date;
                        var splice = date.split("/");
                        var year = Number(splice[2]);
                        var month = Number(splice[0]) - 1;
                        var day = Number(splice[1]);
                        var nextMeet = new Date(year, month, day);
                        var who;

                        if ((nextMeet - today) > 0) {
                            if (school1[0].school_id == '6') {
                                img.setAttribute("src", "./images/BLHS-logo-good.png");
                                img.setAttribute("alt", "Ben Lomond Logo");
                                body.appendChild(img);
                                img2.setAttribute("src", "./images/JayHawk.png");
                                img2.setAttribute("alt", "Jayhawks Logo");
                                body.appendChild(img2);
                                text.innerHTML = "Red and Blue Meet"
                                break;
                            }

                            img.setAttribute("src", "./images/BLHS-logo-good.png");
                            img.setAttribute("alt", "Ben Lomond Logo");
                            body.appendChild(img);
                            // console.log(school1[0].photo)
                            img2.setAttribute("src", "./images/" + school1[0].photo);
                            img2.setAttribute("alt", school1[0].name + " Logo");
                            body.appendChild(img2);
                            who = "VS " + school1[0].name;
                            img3.setAttribute("src", "./images/JayHawk.png");
                            img3.setAttribute("alt", "Jayhawks Logo");
                            body.appendChild(img3);
                            if (school2 != undefined) {
                                img4.setAttribute("src", "./images/" + school2[0].photo);
                                img4.setAttribute("alt", school2[0].name);
                                body.appendChild(img4);
                                who = who + " & " + school2[0].name;
                                text.innerHTML = who;
                            }
                            break;
                        }
                        else {
                            img.setAttribute("src", "./images/BLHS-logo-good.png");
                            img.setAttribute("alt", "Ben Lomond Logo");
                            body.appendChild(img);
                            img2.setAttribute("src", "./images/JayHawk.png");
                            img2.setAttribute("alt", "Jayhawks Logo");
                            body.appendChild(img2);
                            text.innerHTML = "Red and Blue Meet"
                            break;
                        }
                    }
                }
                else {
                    img.setAttribute("src", "./images/BLHS-logo-good.png");
                    img.setAttribute("alt", "Ben Lomond Logo");
                    body.appendChild(img);
                    img2.setAttribute("src", "./images/JayHawk.png");
                    img2.setAttribute("alt", "Jayhawks Logo");
                    body.appendChild(img2);
                    text.innerHTML = "Red and Blue Meet"
                }
            })
            .catch(function (error) {
                console.log("Error: " + error);
            });
        meets();
    }

    function meets() {
        fetch("/api/meets").then(function (resMeets) {
            return resMeets.json();
        })
            .then(function (meets) {
                if (meets[0].year == 2) {
                    var body = document.getElementById("schedule");
                    for (var j = 0; j < meets.length; j++) {
                        var row = document.createElement("tr");
                        var column = document.createElement("td");
                        var cell = row.insertCell();
                        var text = document.createTextNode(column.innerHTML = meets[j].date);
                        cell.appendChild(text);
                        var cell = row.insertCell();
                        var text = document.createTextNode(column.innerHTML = meets[j].location);
                        cell.appendChild(text);
                        var cell = row.insertCell();
                        var text = document.createTextNode(column.innerHTML = meets[j].time);
                        cell.appendChild(text);
                        var cell = row.insertCell();

                        // console.log(meets[j].out == null)
                        if (meets[j].out == null || meets[j].out == "null") {
                            var text = document.createTextNode(column.innerHTML = "");
                        }
                        else {
                            var text = document.createTextNode(column.innerHTML = meets[j].out);
                        }

                        cell.appendChild(text);
                        var cell = row.insertCell();
                        if (meets[j].bus == null|| meets[j].bus == "null") {
                            var text = document.createTextNode(column.innerHTML = "");
                        }
                        else {
                            var text = document.createTextNode(column.innerHTML = meets[j].bus);
                        }

                        cell.appendChild(text);
                        var cell = row.insertCell();
                        if (meets[j].home == null || meets[j].home == "null") {
                            var text = document.createTextNode(column.innerHTML = "");
                        }
                        else {
                            var text = document.createTextNode(column.innerHTML = meets[j].home);
                        }
                        cell.appendChild(text);
                        body.appendChild(row);
                    }
                }
            })
            .catch(function (error) {
                console.log("Error: " + error);
            });
        blog();
    }
</script>

</html>