<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BL/SJ Swim Team- Home</title>
    <link rel="stylesheet" href="swim.css">
    <script src="https://code.jquery.com/jquery-3.3.1.js"
        integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous">
        </script>
    <script>
        $(function () {
            $("#header").load("heading.html");
            $("#footer").load("footing.html");
        });
    </script>
    <style>
        @media only screen and (min-width: 700px) {
            .galleryPic {
                width: 30vw;
                height: 50vh;
            }

            .container2 {
                width: 100vw;
                display: flex;
                justify-content: space-evenly;
                flex-wrap: wrap;
                /* overflow: hidden; */
                /* padding-left: 50px;
            padding-right: 90px; */
            }

            .welcome {
                /* padding-top: 100px; */
                color: white;
                font-size: larger;
                background-color: rgba(0, 0, 0, 0.6);
                text-align: center;
                width: 100vw;
            }

            .schedule {
                /* background-color: whitesmoke; */
                text-align: center;
                font-size: small;
                width: 30vw;
            }

            table {
                background-color: whitesmoke;
                visibility: visible;
            }

            body {
                height: 85vh;
                width: 100vw;
            }

            .nextmeet {
                background-image: url(BenLomond-2.jpg);
                display: flex;
                width: 30vw;
                object-fit: contain;
                background-repeat: no-repeat;
                background-position: center;
                justify-content: space-between;
                align-items: center;
                flex-wrap: wrap;
            }

            .nextmeet img {
                width: 35%;
                height: 35%;
            }

            #blog {
                height: 90%;
                width: 30vw;
                font-size: 17px;
                text-align: center;
                resize: none;

            }

            .state {
                display: flex;
                text-align: center;
                width: 29.5vw;
                ;
                height: 10vh;
                object-fit: cover;
                position: relative;
                top: -105px;
            }
        }

        @media only screen and (max-width: 700px) {
            .galleryPic {
                width: 90vw;
            }

            .container2 {
                height: 85vh;
                width: 100vw;
                /* padding-left: auto; */
                display: flex;
                justify-content: space-evenly;
                flex-wrap: wrap;
                overflow: auto;

            }

            .welcome {
                /* padding-top: 100px; */
                color: white;
                font-size: larger;
                background-color: rgba(0, 0, 0, 0.6);
                text-align: center;
                width: 90vw;
                margin-top: 100px;
            }

            .schedule {
                /* background-color: whitesmoke; */
                text-align: center;
                font-size: small;
                width: 90vw;

            }

            table {
                background-color: whitesmoke;
                visibility: visible;
            }

            body {
                height: 85vh;
                width: 100vw;
            }

            .nextmeet {
                background-image: url(BenLomond-2.jpg);
                display: flex;
                width: 90vw;
                object-fit: contain;
                background-repeat: no-repeat;
                background-position: center;
                justify-content: space-between;
                align-items: center;
                flex-wrap: wrap;
            }

            .nextmeet img {
                width: 35%;
                height: 35%;
            }

            #blog {
                height: 100%;
                width: 90vw;
                font-size: 14px;
                resize: none;
            }

            .state {
                display: flex;
                text-align: center;
            }
        }
    </style>
</head>
<header id="header"></header>

<body onload="against()">
    <div class="container2">
        <div class="schedule">
            <table id="schedule">
                <tr>
                    <th colspan="6"><u>2023-2024 Swim Schedule</u></th>
                </tr>
                <tr><strong>
                        <td>Date/Day</td>
                        <td>Event</td>
                        <td>Time</td>
                        <td>Out</td>
                        <td>Bus</td>
                        <td>Home</td>
                    </strong></tr>
                    <tr><strong>
                        <td>09/05/2023</td>
                        <td>First Day of Conditioning</td>
                        <td>2:45pm</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </strong></tr>
                <tr><strong>
                        <td>09/18/2023</td>
                        <td>Swim Meeting @Pool</td>
                        <td>3:30pm</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </strong></tr>
                    <tr><strong>
                        <td>09/25/2023</td>
                        <td>Parents Meeting Gym #311</td>
                        <td>6:00pm</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </strong></tr>
                <tr><strong>
                        <td>10/02/2023</td>
                        <td>First Day of Practice</td>
                        <td>2:45pm</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </strong></tr>
                    <tr><strong>
                        <td>10/19-20/2023</td>
                        <td>Time Trials</td>
                        <td>2:45pm</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </strong></tr>
                    <tr><strong>
                        <td>11/15/2023</td>
                        <td>Last Day to Join</td>
                        <td>11:59pm</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </strong></tr>
                <tr>
                    <th colspan="6"><u>Season Meets:</u></th>
                </tr>
            </table>
        </div>

        <div class="w3-content w3-section">
            <img id="mySlides" class="galleryPic">
            <div class="state">
                <a href="./stateQualified.html"> <img src="./images/Utah_test.png" style="width:40%;"></a>
            </div>
        </div>
        <div style="background-color: rgba(0, 0, 0, 0.6)">
            <h3 style="color:white; text-align: center; ">Next Meet</h3>
            <div id="nextmeet" class="nextmeet">
            </div>
            <h3 id="meetname" style="color:white; text-align: center;"></h3>
            
            <div style="background-color:white" id="blog"></div>
        
        </div>
    </div>
    <script>
        var slideIndex = 0;
        // var test = Folder("./Gallery/").getFiles();
        //     console.log(test);
        carousel();

        function carousel() {
            var imgArray = [];

            for (i = 0; i < 14; i++) {
                imgArray[i] = new Image();
                imgArray[i] = './Gallery/Quote' + i + '.png';
            }
            var x = document.getElementById("mySlides");
            //console.log(slideIndex)
            if (slideIndex <= imgArray.length) { 
                slideIndex = Math.round(Math.random() * 100) 
                if(slideIndex > 13){
                    slideIndex = Math.round(Math.random() * 10)
                }
            }
            //console.log(slideIndex)
            x.style.display = "block";
            x.src = imgArray[slideIndex].toString();
            slideIndex++;
            setTimeout(carousel, 10000); // Change image every 10 seconds
        }
    </script>
</body>
<footer id="footer"></footer>
<script>

    async function blog() {
        var blog = document.getElementById("blog");
        var hello = await fetch('/api/blog').then(data => data.json())
        blog.innerHTML = hello[0].blog;
    }

    async function against() {
        var today = new Date();
        var body = document.getElementById("nextmeet");
        var text = document.getElementById("meetname")
        var img = document.createElement("img");
        var img2 = document.createElement("img");
        var img3 = document.createElement("img");
        var img4 = document.createElement("img");
        fetch("/api/meets").then(function (resMeets) {
            return resMeets.json();
        })
            .then(async function (meets) {

                for (var j = 0; j < meets.length; j++) {
                    var date = meets[j].date;
                    var splice = date.split("/");
                    var year = Number(splice[2]);
                    var month = Number(splice[0]) - 1;
                    var day = Number(splice[1])+1;
                    var nextMeet = new Date(year, month, day);
                    var who;
                    if (nextMeet - today > 0) {
                        //console.log(meets[j].school1)
                        if (meets[j].school1 != -1) {
                            //console.log("HI")
                            var school1 = await fetch('/api/schools/' + meets[j].school1).then(function (responseRelay) {
                                return responseRelay.json();
                            }).catch(function (error) {
                                console.log("Error: " + error)
                            });
                            var school2;
                            if (meets[j].school2 != null) {
                                //console.log("THERE")
                                school2 = await fetch('/api/schools/' + meets[j].school2).then(function (responseRelay) {
                                    return responseRelay.json();
                                }).catch(function (error) {
                                    console.log("Error: " + error)
                                });
                            }
                            break;
                        }
                        else {
                        console.log("Hello")
                            var school1 = [{ school_id: '-1', name: meets[j].location, photo: './swimCoach.png' }];
                            //console.log(school1)
                            break;
                        }
                    }
                }
                
                if(!school1){
                    
                    img.setAttribute("src", "./images/BLHS.png");
                    img.setAttribute("alt", "Ben Lomond Logo");
                    body.appendChild(img);
                    img2.setAttribute("src", "./images/SJCHS.png");
                    img2.setAttribute("alt", "Jayhawks Logo");
                    body.appendChild(img2);
                    text.innerHTML = "Red and Blue Meet"
                }
                if (school1[0].school_id == 6) {
                    img.setAttribute("src", "./images/BLHS.png");
                    img.setAttribute("alt", "Ben Lomond Logo");
                    body.appendChild(img);
                    img2.setAttribute("src", "./images/SJCHS.png");
                    img2.setAttribute("alt", "Jayhawks Logo");
                    body.appendChild(img2);
                    text.innerHTML = "Red and Blue Meet"
                    // break;
                }
                else {
                    
                    img.setAttribute("src", "./images/BLHS.png");
                    img.setAttribute("alt", "Ben Lomond Logo");
                    body.appendChild(img);
                    console.log(school1[0].name)
                    if(school1[0].name ===  "Region 13 Meet" || school1[0].name === "State Meet"){
                        school1[0].name = "swimCoach"
                    }
                    console.log(school1[0].name)
                    img2.setAttribute("src", "./images/" + school1[0].name+".png");
                    img2.setAttribute("alt", school1[0].name + " Logo");
                    body.appendChild(img2);
                    who = "VS " + school1[0].name;
                    img3.setAttribute("src", "./images/SJCHS.png");
                    img3.setAttribute("alt", "Jayhawks Logo");
                    // img3.setAttribute("style","transform: scaleX(-1)")
                    body.appendChild(img3);
                    if (school2 != undefined) {
                        //console.log("hello")
                        img4.setAttribute("src", "./images/" + school2[0].name+".png");
                        img4.setAttribute("alt", school2[0].name);
                        body.appendChild(img4);
                        who = who + " & " + school2[0].name;
                        text.innerHTML = who;
                    }
                    else{
                        text.innerHTML = who;
                    }
                    
                }
            })
            .catch(function (error) {
                console.log("Error: " + error);
            });
        meets();
    }

    function meets() {
        var today = new Date();
        fetch("/api/meets").then(function (resMeets) {
            return resMeets.json();
        })
            .then(function (meets) {
                //console.log(meets[0].year)
                if (meets[0].year == 4) {
                    var body = document.getElementById("schedule");
                    for (var j = 0; j < meets.length; j++) {
                        var date = meets[j].date;
                    var splice = date.split("/");
                    var year = Number(splice[2]);
                    var month = Number(splice[0]) - 1;
                    var day = Number(splice[1])+1;
                    var nextMeet = new Date(year, month, day);
                        var row = document.createElement("tr");
                        var column = document.createElement("td");
                        var cell = row.insertCell();
                        var text = document.createTextNode(column.innerHTML = meets[j].date);
                        cell.appendChild(text);
                        var cell = row.insertCell();
                        if(nextMeet - today > 0){
                            var text = document.createTextNode(column.innerHTML = meets[j].location);
                        cell.appendChild(text);
                        }
                        else{
                            var text = document.createTextNode(column.innerHTML = meets[j].location);
                        cell.appendChild(text);
                        cell.setAttribute("style","text-decoration: line-through")
                        }
                        var cell = row.insertCell();
                        var text = document.createTextNode(column.innerHTML = meets[j].time);
                        cell.appendChild(text);
                        var cell = row.insertCell();

                        // console.log(meets[j].out == null)
                        if (meets[j].out == null || meets[j].out == "null") {
                            var text = document.createTextNode(column.innerHTML = "");
                        }
                        else {
                            var text = document.createTextNode(column.innerHTML = meets[j].out);
                        }

                        cell.appendChild(text);
                        var cell = row.insertCell();
                        if (meets[j].bus == null || meets[j].bus == "null") {
                            var text = document.createTextNode(column.innerHTML = "");
                        }
                        else {
                            var text = document.createTextNode(column.innerHTML = meets[j].bus);
                        }

                        cell.appendChild(text);
                        var cell = row.insertCell();
                        if (meets[j].home == null || meets[j].home == "null") {
                            var text = document.createTextNode(column.innerHTML = "");
                        }
                        else {
                            var text = document.createTextNode(column.innerHTML = meets[j].home);
                        }
                        cell.appendChild(text);
                        body.appendChild(row);
                    }
                }
            })
            .catch(function (error) {
                console.log("Error: " + error);
            });
        blog();
    }
</script>

</html>